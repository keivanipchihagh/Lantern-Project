{% load static %}

<html>
<head>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/uikit@3.6.14/dist/css/uikit.min.css" />
    <script src="https://cdn.jsdelivr.net/npm/uikit@3.6.14/dist/js/uikit.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/uikit@3.6.14/dist/js/uikit-icons.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vue@2"></script>
    <link href="{% static 'api/styles/style.css' %}" type="text/css" rel="stylesheet" />
</head>

<body>
    {{ room_name|json_script:"room-name" }}        

    <!-- Chatbox App - start -->
    <div id="chatbox-app" class="chatbox-app" v-bind:class="{'chatbox-app-show': showApp, 'chatbox-app-left': (position == 'left')}">    
        <div class="uk-container uk-width-large">
            <div id="chatbox-container" class="uk-card uk-card-default uk-border-rounded uk-margin-large-top chat" v-bind:class="{'uk-app-dark': (theme == 'dark'), 'uk-app-light': (theme == 'light')}">
                <!-- Header - start -->
                <div id="chatbox-header" class="uk-width-auto uk-header" v-bind:class="{'header-high-contrast': headerHighContrast}">
                    <a uk-icon="icon: user" class="uk-hover-blue"></a>
                    <span id="title" class="chatbox-cursor-pointer" v-on:click="toggleApp" v-bind:class="{'header-high-contrast-span': headerHighContrast}"></span><span class="chatbox-icon-green chatbox-icon-status"> â¬¤</span>
                    <ul class="uk-iconnav uk-margin-small-right uk-float-right">
                        <li class="chatbox-icon" v-bind:class="{'chatbox-icon-show': expandApp}" v-if="showSettings">
                            <a class="chatbox-cursor-pointer" uk-icon="icon: settings" title="settings" v-bind:class="{'uk-icon-light': (theme == 'dark')}"></a>

                            <!-- Settings - start -->
                            <div class="chatbox-dropdown" uk-dropdown="pos: bottom-center; animation: uk-animation-slide-top-small; duration: 200">
                                <div class=".uk-container-xsmall" v-if="themeControl">
                                    <span class="chatbox-dropdown-desc">Theme</span>
                                    <ul class="uk-subnav uk-subnav-pill chatbox-cursor-pointer">
                                        <li v-bind:class="{'uk-active': (theme == 'light')}"><a class="chatbox-dropdown-li-radius-left" v-on:click="changeTheme">Light</a></li>
                                        <li v-bind:class="{'uk-active': (theme == 'dark')}"><a class="chatbox-dropdown-li-radius-right" v-on:click="changeTheme">Dark</a></li>
                                    </ul>
                                </div>
                                <br v-if="themeControl && positionControl" />
                                <div class=".uk-container-xsmall" v-if="positionControl">
                                    <span class="chatbox-dropdown-desc">Position</span>
                                    <ul class="uk-subnav uk-subnav-pill chatbox-cursor-pointer">
                                        <li v-bind:class="{'uk-active': (position == 'left')}"><a class="chatbox-dropdown-li-radius-left" v-on:click="changePosition">Left</a></li>
                                        <li v-bind:class="{'uk-active': (position == 'right')}"><a class="chatbox-dropdown-li-radius-right" v-on:click="changePosition">Right</a></li>
                                    </ul>
                                </div>
                            </div>
                            <!-- Settings - end -->
                        </li>
                        <li><a id="toggler" class="chatbox-cursor-pointer" uk-icon="icon: chevron-up" title="maximize" v-bind:class="{'uk-icon-light': (theme == 'dark')}" v-on:click="toggleApp"></a></li>
                        <li><a class="chatbox-cursor-pointer" uk-icon="icon: close" title="close" v-on:click="closeApp" v-bind:class="{'uk-icon-light': (theme == 'dark')}"></a></li>
                    </ul>
                </div>
                <!-- Header - end -->
                <!-- Content - start -->
                <div id="chatbox-content" class="chatbox-content" v-bind:class="{'chatbox-content-show': expandApp}">

                    <!-- Body - start -->
                    <div id="chatbox-body" class="uk-card-body uk-padding-small chatbox-body">

                        <!-- Status - start -->
                        <div id="chatbox-status-container" style="height: 100%; width: 100%; text-align: center;" v-if="!ready & expandApp">
                            <p class="uk-margin-remove uk-select-none"><span class="etc" v-bind:class="{'uk-icon-bg-light': (theme == 'dark')}"><i></i><i></i><i></i></span></p>
                            <p id="chatbox-status" class="uk-margin-remove uk-select-none" style="color: black;" v-bind:class="{'uk-font-light': (theme == 'dark')}">Connecting...</p>
                        </div>
                        <!-- Status - end -->
                        <!-- Chat context - start -->
                        {% comment %} <div id="chat-log" v-if="ready & expandApp">
                            <div v-for="RecievedPackage in packages" v-bind:key="RecievedPackage.id" v-bind:message="RecievedPackage.message" v-bind:datetime="RecievedPackage.datetime" v-bind:id="RecievedPackage.id"></div>
                        </div> {% endcomment %}
                        <div id="chat-log" is="package" v-for="package in packages" v-bind:key="package.id" v-bind:message="package.message" v-bind:_sender="package.sender" v-bind:datetime="package.datetime" v-bind:id="package.id" v-if="ready & expandApp"></div>
                        <!-- Chat context - end -->

                    </div>
                    <!-- Body - end -->
                    <!-- Footer - start -->
                    <div class="uk-card-footer uk-padding-remove uk-stick-bottom" v-show="ready & expandApp">

                        <div class="uk-grid-small uk-flex-middle uk-margin-small-left" uk-grid>
                            <div class="uk-width-expand">
                                <form class="uk-padding-small uk-padding-remove-horizontal">
                                    <textarea id="chat-message-input" class="uk-textarea uk-padding-remove uk-border-remove" rows="2" placeholder="Message..."  v-on:keyup.enter="sendMessage" v-bind:class="{'uk-font-light': (theme == 'dark')}"></textarea>
                                </form>
                            </div>
                            <div class="uk-width-auto">
                                <ul class="uk-iconnav uk-margin-small-right">
                                    <li><a class="chatbox-cursor-pointer" uk-icon="icon: image" title="image" v-bind:class="{'uk-icon-light': (theme == 'dark')}"></a></li>
                                    <li><a id="chat-message-submit" class="chatbox-cursor-pointer chatbox-icon-blue" uk-icon="icon: forward" title="send"></a></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <!-- Footer - end -->
                </div>
                <!-- Content - end -->
            </div>
        </div>
    </div>
    <!-- Chatbox App - end -->

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="{% static 'api/scripts/script.js' %}"></script>
</body>

</html>